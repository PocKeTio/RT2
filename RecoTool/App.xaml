<Application x:Class="RecoTool.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Application.Resources>
        <!-- Styles globaux -->
        <Style TargetType="{x:Type Window}">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <!-- BNP Colors - Base Colors -->
        <Color x:Key="BNPMainGreen">#00785A</Color>
        <Color x:Key="BNPLightGreen">#00985A</Color>
        <Color x:Key="BNPDarkGreen">#1AAFBB</Color>
        <Color x:Key="BNPAccentOrange">#FF9800</Color>
        <Color x:Key="BNPAccentBlue">#2196F3</Color>
        <Color x:Key="BNPBackgroundGray">#F8F9FA</Color>
        <Color x:Key="BNPButtonGreen">#00785A</Color>
        <Color x:Key="BNPKPIBackgroundGreen">#DFF6E4</Color>
        <Color x:Key="BNPKPIForegroundGreen">#333333</Color>

        <!-- BNP Colors - Brushes -->
        <SolidColorBrush x:Key="BNPMainGreenBrush" Color="{StaticResource BNPMainGreen}"/>
        <SolidColorBrush x:Key="BNPLightGreenBrush" Color="{StaticResource BNPLightGreen}"/>
        <SolidColorBrush x:Key="BNPDarkGreenBrush" Color="{StaticResource BNPDarkGreen}"/>
        <SolidColorBrush x:Key="BNPAccentOrangeBrush" Color="{StaticResource BNPAccentOrange}"/>
        <SolidColorBrush x:Key="BNPKPIBackgroundGreenBrush" Color="{StaticResource BNPKPIBackgroundGreen}"/>
        <SolidColorBrush x:Key="BNPKPIForegroundGreenBrush" Color="{StaticResource BNPKPIForegroundGreen}"/>

        <!-- Couleurs d'interface standard -->
        <SolidColorBrush x:Key="BNPSectionBackground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BNPBorderBrush" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="BNPHeaderBackground" Color="#006A4D"/>
        <SolidColorBrush x:Key="BNPSidebarBackground" Color="#F5F5F5"/>
        <SolidColorBrush x:Key="BNPAccentBrush" Color="#FF9800"/>
        <SolidColorBrush x:Key="BNPErrorBrush" Color="#D32F2F"/>
        <SolidColorBrush x:Key="BNPSuccessBrush" Color="#388E3C"/>
        <SolidColorBrush x:Key="BNPWarningBrush" Color="#FFA000"/>
        <SolidColorBrush x:Key="BNPInfoBrush" Color="#1976D2"/>
        <SolidColorBrush x:Key="BNPTextPrimaryBrush" Color="#212121"/>
        <SolidColorBrush x:Key="BNPTextSecondaryBrush" Color="#757575"/>
        <SolidColorBrush x:Key="BNPTextDisabledBrush" Color="#9E9E9E"/>
        <SolidColorBrush x:Key="BNPTextOnPrimaryBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BNPDividerBrush" Color="#EEEEEE"/>
        <SolidColorBrush x:Key="BNPBackgroundBrush" Color="#F9F9F9"/>
        <SolidColorBrush x:Key="BNPSurfaceBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BNPPrimaryVariantBrush" Color="#004D3D"/>

        <!-- Couleurs pour le ruban -->
        <SolidColorBrush x:Key="BNPRibbonBackground" Color="#F5F9F7"/>
        <SolidColorBrush x:Key="BNPRibbonBorder" Color="#D0E0D8"/>
        <SolidColorBrush x:Key="BNPRibbonText" Color="#333333"/>
        <SolidColorBrush x:Key="BNPRibbonHoverBackground" Color="#E8F5EE"/>
        <SolidColorBrush x:Key="BNPRibbonActiveBackground" Color="#D6EBE2"/>
        <SolidColorBrush x:Key="BNPBackground" Color="{StaticResource BNPBackgroundGray}"/>
        <SolidColorBrush x:Key="BNPButton" Color="{StaticResource BNPButtonGreen}"/>
        <SolidColorBrush x:Key="BNPRibbon" Color="{StaticResource BNPMainGreen}"/>
        <SolidColorBrush x:Key="BNPKPIBackground" Color="{StaticResource BNPKPIBackgroundGreen}"/>
        <SolidColorBrush x:Key="BNPKPIForeground" Color="{StaticResource BNPKPIForegroundGreen}"/>
        <SolidColorBrush x:Key="BNPTextBrush" Color="#333333"/>
        <SolidColorBrush x:Key="BNPSecondaryTextBrush" Color="#6C757D"/>

        <!-- Additional UI Colors -->
        <SolidColorBrush x:Key="BNPHeaderForeground" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BNPHoverBackground" Color="#D6EFE4"/>
        <SolidColorBrush x:Key="BNPActiveBackground" Color="#B3E0CF"/>

        <!-- Style amélioré pour les boutons du ruban -->
        <Style x:Key="RibbonButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="18,12"/>
            <Setter Property="Margin" Value="8,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#E8F5EE"/>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="1" Direction="315" Opacity="0.2" BlurRadius="4"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#D6EBE2"/>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" Direction="315" Opacity="0.1" BlurRadius="2"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Effets et ressources -->
        <DropShadowEffect x:Key="StandardShadow" ShadowDepth="2" Direction="315" Opacity="0.3" BlurRadius="5"/>
        <DropShadowEffect x:Key="LightShadow" ShadowDepth="1" Direction="315" Opacity="0.2" BlurRadius="3"/>

        <!-- Modern Button Styles -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#EEEEEE"/>
                                <Setter Property="BorderBrush" Value="#CCCCCC"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#E0E0E0"/>
                                <Setter Property="BorderBrush" Value="#BBBBBB"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModernPrimaryButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="{StaticResource BNPMainGreenBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BNPMainGreenBrush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource BNPLightGreenBrush}"/>
                                <Setter Property="BorderBrush" Value="{StaticResource BNPLightGreenBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource BNPMainGreenBrush}"/>
                                <Setter Property="BorderBrush" Value="{StaticResource BNPMainGreenBrush}"/>
                                <Setter Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" Direction="0" Opacity="0.3" BlurRadius="5"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style pour les ComboBox -->
        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="{StaticResource BNPMainGreenBrush}"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,5"/>
        </Style>

        <!-- Style pour les boutons standard - Amélioré pour une meilleure ergonomie -->
        <Style x:Key="StandardButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource BNPMainGreenBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="18,10"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="1" Direction="315" Opacity="0.2" BlurRadius="3"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4" 
                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="#005B46"/>
                                        <!-- Slightly darker green on hover -->
                                    </Setter.Value>
                                </Setter>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="2" Direction="315" Opacity="0.3" BlurRadius="5"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background">
                                    <Setter.Value>
                                        <SolidColorBrush Color="#004D3D"/>
                                        <!-- Even darker on press -->
                                    </Setter.Value>
                                </Setter>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="0" Direction="315" Opacity="0.1" BlurRadius="2"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#CCCCCC"/>
                                <Setter Property="Foreground" Value="#888888"/>
                                <Setter TargetName="border" Property="Effect" Value="{x:Null}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style pour les KPI Cards - Amélioré pour une meilleure présentation -->
        <Style x:Key="KPICardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BNPSectionBackground}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="BorderBrush" Value="{StaticResource BNPBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="1" Direction="315" Opacity="0.15" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <EventTrigger RoutedEvent="Border.Loaded">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.4"/>
                            <ThicknessAnimation Storyboard.TargetProperty="Margin" From="0,8,0,0" To="0,0,0,0" Duration="0:0:0.5"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
                <EventTrigger RoutedEvent="Border.MouseEnter">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="(Effect).BlurRadius" To="12" Duration="0:0:0.2"/>
                            <DoubleAnimation Storyboard.TargetProperty="(Effect).ShadowDepth" To="2" Duration="0:0:0.2"/>
                            <DoubleAnimation Storyboard.TargetProperty="(Effect).Opacity" To="0.25" Duration="0:0:0.2"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
                <EventTrigger RoutedEvent="Border.MouseLeave">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="(Effect).BlurRadius" To="8" Duration="0:0:0.2"/>
                            <DoubleAnimation Storyboard.TargetProperty="(Effect).ShadowDepth" To="1" Duration="0:0:0.2"/>
                            <DoubleAnimation Storyboard.TargetProperty="(Effect).Opacity" To="0.15" Duration="0:0:0.2"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Style.Triggers>
        </Style>

        <!-- Style pour le DataGrid -->
        <Style x:Key="ModernDataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="RowHeight" Value="35"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="AlternatingRowBackground" Value="#F9F9F9"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#EEEEEE"/>
            <Setter Property="VerticalGridLinesBrush" Value="Transparent"/>
        </Style>

        <!-- Style pour les en-têtes de DataGrid -->
        <Style x:Key="DataGridColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="{StaticResource BNPMainGreenBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="BorderThickness" Value="0,0,1,0"/>
            <Setter Property="BorderBrush" Value="#DDDDDD"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
        </Style>

        <!-- Style pour les cellules de DataGrid -->
        <Style x:Key="DataGridCellStyle" TargetType="{x:Type DataGridCell}">
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridCell}">
                        <Border Padding="{TemplateBinding Padding}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                            <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#E8F5E9"/>
                    <Setter Property="Foreground" Value="#333333"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style pour les boutons d'icône -->
        <Style x:Key="IconButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource BNPMainGreenBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#10006A4D"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#20006A4D"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Application.Resources>
</Application>