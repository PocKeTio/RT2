<Window x:Class="RecoTool.UI.Views.Windows.ReconciliationDetailWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:RecoTool.UI.Views.Windows"
        mc:Ignorable="d"
        Title="Reconciliation Detail" Height="700" Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource BNPBackground}"
        ShowInTaskbar="True">
    <Window.Resources>
        <!-- Shadow Effects -->
        <DropShadowEffect x:Key="StandardShadow" Direction="270" BlurRadius="10" ShadowDepth="3" Opacity="0.2" />
        <DropShadowEffect x:Key="LightShadow" Direction="270" BlurRadius="5" ShadowDepth="2" Opacity="0.2" />
        
        <!-- ComboBox Style -->
        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Height" Value="30" />
            <Setter Property="Padding" Value="8,5" />
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#DDDDDD" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>
        
        <!-- TextBox Style -->
        <Style x:Key="ModernTextBoxStyle" TargetType="TextBox">
            <Setter Property="Height" Value="30" />
            <Setter Property="Padding" Value="8,5" />
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#DDDDDD" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>
        
        <!-- DatePicker Style -->
        <Style x:Key="ModernDatePickerStyle" TargetType="DatePicker">
            <Setter Property="Height" Value="30" />
            <Setter Property="Padding" Value="8,5" />
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#DDDDDD" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>
        
        <!-- Label Style -->
        <Style x:Key="FieldLabelStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,0,10,0" />
        </Style>
        
        <!-- Value TextBlock Style -->
        <Style x:Key="FieldValueStyle" TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="TextWrapping" Value="Wrap" />
        </Style>
    </Window.Resources>
    
    <Border BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Margin="10">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Background="{DynamicResource BNPMainGreenBrush}" Padding="15,10" CornerRadius="8,8,0,0">
                <StackPanel Orientation="Horizontal">
                    <Border Background="#FFFFFF" CornerRadius="50" Width="32" Height="32" Margin="0,0,12,0">
                        <TextBlock x:Name="HeaderIcon" Text="&#xE8EC;" FontFamily="Segoe MDL2 Assets" FontSize="16" Foreground="{DynamicResource BNPMainGreenBrush}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <TextBlock x:Name="HeaderText" Text="Reconciliation Detail" FontSize="18" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Content -->
            <Grid Grid.Row="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Section supérieure : Détails de l'opération -->
                <Border Grid.Row="0" Background="White" Margin="0,0,0,5" Padding="15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Titre de la section -->
                        <DockPanel Grid.Row="0" LastChildFill="True" Margin="0,0,0,10">
                            <TextBlock Text="Operation Details" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource BNPMainGreenBrush}"/>
                            <TextBlock x:Name="AccountTypeText" Text="Account Type: Receivable" HorizontalAlignment="Right" FontWeight="SemiBold"/>
                        </DockPanel>
                        
                        <!-- Contenu des détails -->
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Colonne de gauche -->
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <!-- Informations générales -->
                                    <GroupBox Header="General Information" Margin="0,0,0,10" BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Date d'opération -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Date:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="OperationDateValue" Grid.Row="0" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                            
                                            <!-- Description -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Description:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="DescriptionValue" Grid.Row="1" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                            
                                            <!-- Montant -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Amount:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="AmountValue" Grid.Row="2" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                            
                                            <!-- Devise -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Currency:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="CurrencyValue" Grid.Row="3" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                            
                                            <!-- Status -->
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Status:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="StatusValue" Grid.Row="4" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                            
                                            <!-- Référence -->
                                            <TextBlock Grid.Row="5" Grid.Column="0" Text="Reference:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="ReferenceValue" Grid.Row="5" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <!-- Country -->
                                            <TextBlock Grid.Row="6" Grid.Column="0" Text="Country:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="CountryValue" Grid.Row="6" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <!-- Account -->
                                            <TextBlock Grid.Row="7" Grid.Column="0" Text="Account:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="AccountIdValue" Grid.Row="7" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <!-- Event -->
                                            <TextBlock Grid.Row="8" Grid.Column="0" Text="Event Num:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="EventNumValue" Grid.Row="8" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                        </Grid>
                                    </GroupBox>
                                    
                                    <!-- Informations financières -->
                                    <GroupBox Header="Financial Information" Margin="0,0,0,10" BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Montant en EUR -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Amount EUR:" Style="{StaticResource FieldLabelStyle}"/>
                                            <TextBlock x:Name="AmountInEURValue" Grid.Row="0" Grid.Column="1" Style="{StaticResource FieldValueStyle}"/>
                                            
                                            <!-- Montant en KEUR -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Amount KEUR:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="AmountInKEURValue" Grid.Row="1" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                            
                                            <!-- Taux de change -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Exchange Rate:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="FXRateValue" Grid.Row="2" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                            
                                            <!-- Date de valeur -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Value Date:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="ValueDateValue" Grid.Row="3" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                            
                                            <!-- Type de transaction -->
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Type:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="TransactionTypeValue" Grid.Row="4" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                        </Grid>
                                    </GroupBox>
                                </StackPanel>
                                
                                <!-- Colonne de droite -->
                                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                    <!-- Informations client -->
                                    <GroupBox Header="Client Information" Margin="0,0,0,10" BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Nom du débiteur -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Client/Bank:" Style="{StaticResource FieldLabelStyle}"/>
                                            <TextBlock x:Name="DebtorNameValue" Grid.Row="0" Grid.Column="1" Style="{StaticResource FieldValueStyle}"/>
                                            
                                            <!-- Facture -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Invoice:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="InvoiceValue" Grid.Row="1" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <!-- Groupe -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Group:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="GroupNameValue" Grid.Row="2" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <!-- Swift Code (from Ambre) -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Swift Code:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="SwiftCodeValue" Grid.Row="3" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <!-- DWINGS IDs (display) -->
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="DWINGS IDs:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="DwingsIdsValue" Grid.Row="4" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                        </Grid>
                                    </GroupBox>

                                    <!-- DWINGS Guarantee Details -->
                                    <GroupBox Header="DWINGS Guarantee" Margin="0,0,0,10" BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Nature:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="GNatureValue" Grid.Row="0" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Status:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="GStatusValue" Grid.Row="1" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Issue Date:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="GIssueDateValue" Grid.Row="2" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Party ID:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="GPartyIdValue" Grid.Row="3" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Name:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="GName1Value" Grid.Row="4" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                        </Grid>
                                    </GroupBox>

                                    <!-- DWINGS Invoice Details -->
                                    <GroupBox Header="DWINGS Invoice" Margin="0,0,0,10" BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="160"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Requested Amount:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="IRequestedAmountValue" Grid.Row="0" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Billing Currency:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="IBillingCurrencyValue" Grid.Row="1" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Start Date:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="IStartDateValue" Grid.Row="2" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="End Date:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="IEndDateValue" Grid.Row="3" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Status:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="IStatusValue" Grid.Row="4" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>

                                            <TextBlock Grid.Row="5" Grid.Column="0" Text="Business Case Ref:" Style="{StaticResource FieldLabelStyle}" Margin="0,5,10,0"/>
                                            <TextBlock x:Name="IBusinessCaseRefValue" Grid.Row="5" Grid.Column="1" Style="{StaticResource FieldValueStyle}" Margin="0,5,0,0"/>
                                        </Grid>
                                    </GroupBox>

                                    <!-- Additional Data (MbawData, SpiritData) -->
                                    <GroupBox Header="Additional Data" Margin="0,0,0,10" BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="140"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Mbaw Data:" Style="{StaticResource FieldLabelStyle}" VerticalAlignment="Top"/>
                                            <TextBox x:Name="MbawDataTextBox" Grid.Row="0" Grid.Column="1" TextWrapping="Wrap" AcceptsReturn="True" Height="80"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Spirit Data:" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0" VerticalAlignment="Top"/>
                                            <TextBox x:Name="SpiritDataTextBox" Grid.Row="1" Grid.Column="1" TextWrapping="Wrap" AcceptsReturn="True" Height="80" Margin="0,10,0,0"/>
                                        </Grid>
                                    </GroupBox>

                                    <!-- Informations utilisateur (modifiables) -->
                                    <GroupBox Header="User Information" Margin="0,0,0,10" BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Action -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Action:" Style="{StaticResource FieldLabelStyle}"/>
                                            <ComboBox x:Name="ActionComboBox" Grid.Row="0" Grid.Column="1" Style="{StaticResource ModernComboBoxStyle}"
                                                      ItemsSource="{Binding ActionOptions}" DisplayMemberPath="Content" SelectedValuePath="Id"
                                                      SelectedValue="{Binding SelectedActionId, Mode=TwoWay}"/>

                                            <!-- KPI -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="KPI:" Style="{StaticResource FieldLabelStyle}"/>
                                            <ComboBox x:Name="KPIComboBox" Grid.Row="1" Grid.Column="1" Style="{StaticResource ModernComboBoxStyle}"
                                                      ItemsSource="{Binding KPIOptions}" DisplayMemberPath="Content" SelectedValuePath="Id"
                                                      SelectedValue="{Binding SelectedKPIId, Mode=TwoWay}"/>

                                            <!-- Incident Type -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Incident Type:" Style="{StaticResource FieldLabelStyle}"/>
                                            <ComboBox x:Name="IncidentTypeComboBox" Grid.Row="2" Grid.Column="1" Style="{StaticResource ModernComboBoxStyle}"
                                                      ItemsSource="{Binding IncidentTypeOptions}" DisplayMemberPath="Content" SelectedValuePath="Id"
                                                      SelectedValue="{Binding SelectedIncidentTypeId, Mode=TwoWay}"/>

                                            <!-- Assignee (placeholder static list) -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Assignee:" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0"/>
                                            <ComboBox x:Name="AssigneeComboBox" Grid.Row="3" Grid.Column="1" Style="{StaticResource ModernComboBoxStyle}" Margin="0,10,0,0">
                                                <ComboBoxItem>Not Assigned</ComboBoxItem>
                                                <ComboBoxItem>John Doe</ComboBoxItem>
                                                <ComboBoxItem>Jane Smith</ComboBoxItem>
                                                <ComboBoxItem>Robert Johnson</ComboBoxItem>
                                                <ComboBoxItem>Emily Davis</ComboBoxItem>
                                            </ComboBox>

                                            <!-- Reminder -->
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Reminder:" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0"/>
                                            <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" Margin="0,10,0,0">
                                                <CheckBox x:Name="ToRemindCheckBox" Content="To Remind" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                <DatePicker x:Name="ReminderDatePicker" Style="{StaticResource ModernDatePickerStyle}" Width="160"/>
                                            </StackPanel>

                                            <!-- ACK -->
                                            <TextBlock Grid.Row="5" Grid.Column="0" Text="ACK:" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0"/>
                                            <CheckBox x:Name="AckCheckBox" Grid.Row="5" Grid.Column="1" VerticalAlignment="Center" Margin="0,10,0,0"/>

                                            <!-- Comment -->
                                            <TextBlock Grid.Row="6" Grid.Column="0" Text="Comment:" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0" VerticalAlignment="Top"/>
                                            <TextBox x:Name="CommentTextBox" Grid.Row="6" Grid.Column="1" TextWrapping="Wrap" AcceptsReturn="True" Height="60" Margin="0,10,0,0"/>

                                            <!-- Swift Code (editable) -->
                                            <TextBlock Grid.Row="7" Grid.Column="0" Text="Swift Code:" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0"/>
                                            <TextBox x:Name="SwiftCodeTextBox" Grid.Row="7" Grid.Column="1" Style="{StaticResource ModernTextBoxStyle}" Margin="0,10,0,0"/>

                                            <!-- Payment Ref -->
                                            <TextBlock Grid.Row="8" Grid.Column="0" Text="Payment Ref:" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0"/>
                                            <TextBox x:Name="PaymentRefTextBox" Grid.Row="8" Grid.Column="1" Style="{StaticResource ModernTextBoxStyle}" Margin="0,10,0,0"/>

                                            <!-- Internal Ref -->
                                            <TextBlock Grid.Row="9" Grid.Column="0" Text="Internal Ref:" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0"/>
                                            <TextBox x:Name="InternalRefTextBox" Grid.Row="9" Grid.Column="1" Style="{StaticResource ModernTextBoxStyle}" Margin="0,10,0,0"/>
                                        </Grid>
                                    </GroupBox>

                                    <!-- Additional Reconciliation Flags -->
                                    <GroupBox Header="Risk and Reason" Margin="0,0,0,10" BorderBrush="{DynamicResource BNPBorderBrush}" BorderThickness="1" Padding="10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Risky Item:" Style="{StaticResource FieldLabelStyle}"/>
                                            <TextBox x:Name="RiskyItemTextBox" Grid.Row="0" Grid.Column="1" Style="{StaticResource ModernTextBoxStyle}"/>

                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Reason (Non-Risky):" Style="{StaticResource FieldLabelStyle}" Margin="0,10,10,0"/>
                                            <ComboBox x:Name="ReasonNonRiskyComboBox" Grid.Row="1" Grid.Column="1" Style="{StaticResource ModernComboBoxStyle}" Margin="0,10,0,0"
                                                      ItemsSource="{Binding ReasonOptions}" DisplayMemberPath="Content" SelectedValuePath="Id"
                                                      SelectedValue="{Binding SelectedReasonId, Mode=TwoWay}"/>
                                        </Grid>
                                    </GroupBox>
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                    </Grid>
                </Border>

                <!-- Section inférieure : Aide à la réconciliation -->
                <Border Grid.Row="1" Background="White" Margin="0,5,0,0" Padding="15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Titre de la section -->
                        <DockPanel Grid.Row="0" LastChildFill="True" Margin="0,0,0,10">
                            <TextBlock Text="Reconciliation Assistance" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource BNPMainGreenBrush}"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="RefreshMatchingButton" Content="Refresh" Click="RefreshMatching_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,10,0" Padding="10,5" Height="30"/>
                                <ComboBox x:Name="MatchingTypeComboBox" Width="150" Style="{StaticResource ModernComboBoxStyle}">
                                    <ComboBoxItem IsSelected="True">Matching Lines</ComboBoxItem>
                                    <ComboBoxItem>Suggestions</ComboBoxItem>
                                </ComboBox>
                            </StackPanel>
                        </DockPanel>
                        
                        <!-- Tableau des correspondances -->
                        <DataGrid Grid.Row="1" x:Name="MatchingDataGrid" Style="{StaticResource ModernDataGridStyle}"
                                  ColumnHeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                                  CellStyle="{StaticResource DataGridCellStyle}"
                                  AutoGenerateColumns="False" SelectionMode="Single"
                                  Margin="0" BorderThickness="1" BorderBrush="#DDDDDD" MaxHeight="200">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Date" Binding="{Binding OperationDate}" Width="100"/>
                                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="200"/>
                                <DataGridTextColumn Header="Montant" Binding="{Binding Amount}" Width="100"/>
                                <DataGridTextColumn Header="Devise" Binding="{Binding Currency}" Width="70"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTextColumn Header="Référence" Binding="{Binding DwingsRef}" Width="120"/>
                                <DataGridTextColumn Header="Client/Bank" Binding="{Binding DebtorName}" Width="150"/>
                                <DataGridTemplateColumn Header="Actions" Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Style="{StaticResource IconButtonStyle}" Click="LinkItems_Click" ToolTip="Link" Margin="0,0,5,0">
                                                    <TextBlock Text="&#xE71B;" FontFamily="Segoe MDL2 Assets" FontSize="14"/>
                                                </Button>
                                                <Button Style="{StaticResource IconButtonStyle}" Click="ViewDetail_Click" ToolTip="View Detail">
                                                    <TextBlock Text="&#xE8A0;" FontFamily="Segoe MDL2 Assets" FontSize="14"/>
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </Grid>

            <!-- Footer avec boutons -->
            <Grid Grid.Row="2" Margin="0,15,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock x:Name="StatusText" Grid.Column="0" VerticalAlignment="Center" Foreground="{DynamicResource BNPMainGreenBrush}" FontStyle="Italic"/>
                <Button x:Name="CancelButton" Grid.Column="1" Content="Cancel" Click="CancelButton_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,10,0" Padding="15,8" MinWidth="100"/>
                <Button x:Name="SaveButton" Grid.Column="2" Content="Save" Click="SaveButton_Click" Style="{StaticResource ModernPrimaryButtonStyle}" Padding="15,8" MinWidth="100"/>
            </Grid>
        </Grid>
    </Border>
</Window>
